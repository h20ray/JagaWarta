(()=>{(function(){"use strict";if(!document.querySelector("[data-jagawarta-header]"))return;let c=document.getElementById("header-nav"),l=document.getElementById("header-logo"),u=document.getElementById("mobile-menu-btn"),f=document.getElementById("header-search-container"),e=document.getElementById("search-wrapper"),a=document.getElementById("header-search"),o=document.getElementById("search-close-btn"),s=document.getElementById("search-results"),r=document.getElementById("search-placeholder-text"),n=document.getElementById("search-scrim");if(!e||!a||!s)return;let w=window.jagawarta_header?.ajax_url||"/wp-admin/admin-ajax.php",v=100,E=200,L,b=["w-12","h-12","justify-center","px-0","bg-transparent","border-0","hover:bg-surface-high","text-on-surface","md:w-auto","md:h-12","md:justify-start","md:px-4","md:bg-surface-low","md:border","md:border-outline-variant","md:text-on-surface-variant","md:hover:bg-surface-mid","md:hover:border-outline"],g=["w-[90vw]","md:w-search-width","h-12","bg-surface","shadow-elevation-2","border-0","pl-6","pr-0","cursor-text","pointer-events-auto","text-on-surface"];function y(){let t=e.getBoundingClientRect().width;e.style.width=t+"px",e.style.minWidth=t+"px";let i=window.matchMedia("(min-width: 768px)").matches;c&&c.classList.add("opacity-0","-translate-x-8","pointer-events-none"),l&&!i&&l.classList.add("opacity-0","pointer-events-none"),u&&u.classList.add("opacity-0","pointer-events-none"),n&&(n.hidden=!1,n.setAttribute("aria-hidden","false"),requestAnimationFrame(()=>n.classList.add("is-open"))),e.classList.add("search-border-fade","border-transparent","shadow-elevation-1"),e.classList.remove("md:border-outline-variant"),r&&r.classList.add("opacity-0"),setTimeout(()=>{f.classList.add("absolute","left-1/2","-translate-x-1/2","z-40","w-auto","h-full","flex","items-center","justify-center","pointer-events-none"),e.style.width="",e.style.minWidth="",e.classList.remove("search-border-fade","border","border-transparent","shadow-elevation-1"),e.classList.remove(...b),e.classList.add(...g),a.classList.remove("opacity-0","pointer-events-none"),a.classList.add("opacity-100","pointer-events-auto"),o.classList.remove("hidden","opacity-0"),o.classList.add("flex","opacity-100"),a.focus()},v)}function m(){c&&c.classList.remove("opacity-0","-translate-x-8","pointer-events-none"),l&&l.classList.remove("opacity-0","pointer-events-none"),u&&u.classList.remove("opacity-0","pointer-events-none"),n&&(n.classList.remove("is-open"),n.setAttribute("aria-hidden","true"),setTimeout(()=>{n.hidden=!0},300)),f.classList.remove("absolute","left-1/2","-translate-x-1/2","z-40","w-auto","h-full","flex","items-center","justify-center","pointer-events-none"),e.style.width="",e.style.minWidth="",e.classList.remove(...g),e.classList.add(...b,"cursor-pointer"),e.classList.add("border-transparent"),setTimeout(()=>{e.classList.add("search-border-fade"),e.classList.remove("border-transparent"),e.classList.add("md:border-outline-variant"),setTimeout(()=>e.classList.remove("search-border-fade"),v)},E),r&&r.classList.remove("opacity-0"),a.classList.add("opacity-0","pointer-events-none"),a.classList.remove("opacity-100","pointer-events-auto"),o.classList.add("hidden","opacity-0"),o.classList.remove("flex","opacity-100"),a.value="",s.classList.add("hidden"),s.innerHTML=""}e.addEventListener("click",()=>{a.classList.contains("opacity-0")&&y()}),r&&r.addEventListener("click",t=>{t.stopPropagation(),y()}),o.addEventListener("click",t=>{t.stopPropagation(),m()}),n&&n.addEventListener("click",()=>m()),document.addEventListener("keydown",t=>{t.key==="Escape"&&m()}),document.addEventListener("click",t=>{!e.contains(t.target)&&!a.classList.contains("opacity-0")&&m()});function j(){let t=Array(3).fill(0).map(()=>`
      <div class="flex items-center gap-4 p-3 animate-pulse">
        <div class="w-12 h-12 rounded-md bg-surface-high flex-shrink-0"></div>
        <div class="flex flex-col flex-1 gap-2">
          <div class="h-4 bg-surface-high rounded w-3/4"></div>
          <div class="h-3 bg-surface-high rounded w-1/4"></div>
        </div>
      </div>
    `).join("");s.innerHTML=`<div class="p-2">${t}</div>`,s.classList.remove("hidden"),s.classList.add("animate-fade-in")}function x(t,i=!1){let h=Array.isArray(t)?t:[];if(h.length===0){s.innerHTML='<div class="p-4 text-body-medium text-on-surface-variant text-center">No results found.</div>',s.classList.remove("hidden");return}let p="";i&&(p='<div class="px-4 py-2 text-label-medium text-on-surface-variant border-b border-outline-variant">No results found. Recommended:</div>');let B=h.map(d=>`
      <a href="${d.url}" class="flex items-center gap-4 p-3 hover:bg-surface-high rounded-lg transition-colors group decoration-none border-none outline-none">
        ${d.thumb?`<img src="${d.thumb}" alt="" class="w-12 h-12 rounded-md object-cover bg-surface-highest flex-shrink-0 shadow-sm">`:""}
        <div class="flex flex-col">
          <span class="text-body-medium font-medium text-on-surface line-clamp-2 leading-snug group-hover:text-primary transition-colors">${d.title}</span>
          <span class="text-label-small text-on-surface-variant mt-0.5">${d.date}</span>
        </div>
      </a>
    `).join("");s.innerHTML=`<div class="p-1 flex flex-col border-none outline-none">${p}${B}</div>`,s.classList.remove("hidden")}function k(t){if(t.length<3){s.classList.add("hidden");return}j(),fetch(`${w}?action=jagawarta_live_search&s=${encodeURIComponent(t)}`).then(i=>i.json()).then(i=>{if(i.success&&i.data){let h=i.data.data,p=i.data.is_fallback;x(h,p)}else x([])}).catch(()=>s.classList.add("hidden"))}a.addEventListener("input",t=>{clearTimeout(L),L=setTimeout(()=>k(t.target.value),300)})})();})();
